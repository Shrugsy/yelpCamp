<%- include('../partials/header') %>

<div class="row">
    <div class="col-md-3">
        <p>
            <a class="btn btn-danger" href="/campgrounds">< Back to all Campgrounds</a>
        </p>
        <p class="lead">YelpCamp</p>

        <div class="list-group pb-3">
            <li class="list-group-item active">Info 1</li>
            <li class="list-group-item">Info 2</li>
            <li class="list-group-item">Info 3</li>
        </div>

    </div>
    <div class="col-md-9">
        <div class="img-thumbnail">
            <img class="img-fluid" src="<%= campground.image %>" alt="">
            <div class="p-2">
                <h4 class="float-right">$9.00/night</h4>
                <h4><a href=""><%= campground.name %></a></h4>
                <p><em>Submitted by <%= campground.author.username  %></em></p>
                <p><%= campground.description  %></p>

                <% if(currentUser && campground.author.id && campground.author.id.equals(currentUser._id)){ %>
                    <a class="btn btn-info" href="/campgrounds/<%= campground._id %>/edit">Edit this entry</a>
                    <form class="d-inline" action="/campgrounds/<%= campground._id %>?_method=delete" method="POST">
                        <button class="btn btn-danger">Delete entry</button>
                    </form>
                <% } %>


            </div>
        </div>

        <div class="img-thumbnail card-header mt-3 p-2">
            
            <div class="float-right">
                <a class="btn btn-success" href="/campgrounds/<%=campground._id%>/comments/new">Add a comment</a>
            </div>
            <h2>Comments</h2>
            <hr>
            <% if (currentUser){ %>
                <%- include('../comments/new') %>
            <% } else { %>
                <span><em><a href="/login">Please log in to add a comment</a></em></span>
            <% } %>
            <% campground.comments.forEach((comment)=>{ %>
                <div class="row">
                    <div class="col-md-12">
                        <strong><%= comment.author.username %></strong>
                        <span class="float-right">10 days ago</span>
                        <p><%= comment.text %></p>

                        <% if(currentUser && comment.author.id && comment.author.id.equals(currentUser._id)){ %>
                        <a href="/campgrounds/<%=campground._id%>/comments/<%=comment._id%>/edit" 
                            class="btn btn-xs btn-warning">
                            Edit
                        </a>
                        <form class="d-inline" action="/campgrounds/<%=campground._id%>/comments/<%=comment._id%>?_method=DELETE" method="POST">
                        <button class="btn btn-xs btn-danger">Delete</button>
                        </form>
                        <% } %>

                    </div>
                </div>

                
            <% }) %>
        </div>
    
        


        

    </div>
</div>




<%- include('../partials/footer') %>